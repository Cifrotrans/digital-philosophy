<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>SEO Auditor (Browser Version)</title>
<style>
    body { font-family: Arial; max-width: 800px; margin: 20px auto; }
    input, button { padding: 10px; font-size: 16px; width: 100%; margin-bottom: 10px; }
    button { cursor: pointer; }
    pre { background: #f7f7f7; padding: 15px; border-radius: 8px; white-space: pre-wrap; }
</style>
</head>
<body>

<h2>üîç SEO-–ê–£–î–ò–¢ –°–ê–ô–¢–ê (–±—Ä–∞—É–∑–µ—Ä–Ω–∞—è –≤–µ—Ä—Å–∏—è)</h2>

<input id="urlInput" placeholder="–í–≤–µ–¥–∏—Ç–µ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä https://site.com)">
<button onclick="runAudit()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∞–π—Ç</button>

<pre id="output"></pre>

<script>
async function fetchHTML(url) {
    // –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π CORS-–ø—Ä–æ–∫—Å–∏
    const proxy = "https://api.allorigins.win/raw?url=" + encodeURIComponent(url);

    try {
        const response = await fetch(proxy);
        return await response.text();
    } catch (e) {
        return null;
    }
}

function absoluteUrl(base, relative) {
    try { return new URL(relative, base).href; }
    catch { return null; }
}

function extractSEO(url, html) {
    const doc = new DOMParser().parseFromString(html, "text/html");

    let data = {
        url: url,
        title: doc.querySelector("title")?.innerText || "",
        description: doc.querySelector('meta[name="description"]')?.content || "",
        keywords: doc.querySelector('meta[name="keywords"]')?.content || "",
        h1: [...doc.querySelectorAll("h1")].map(h => h.innerText.trim()),
        h2: doc.querySelectorAll("h2").length,
        h3: doc.querySelectorAll("h3").length,
        images_total: 0,
        images_missing_alt: 0,
        internal_links: 0,
        external_links: 0,
        issues: []
    };

    // H1
    if (data.h1.length === 0) data.issues.push("‚ùå –ù–µ—Ç H1");
    if (data.h1.length > 1) data.issues.push("‚ö†Ô∏è –ù–µ—Å–∫–æ–ª—å–∫–æ H1");

    // Title
    if (!data.title) data.issues.push("‚ùå –ù–µ—Ç Title");
    else if (data.title.length < 50) data.issues.push("‚ö†Ô∏è Title –∫–æ—Ä–æ—Ç–∫–∏–π");
    else if (data.title.length > 70) data.issues.push("‚ö†Ô∏è Title –¥–ª–∏–Ω–Ω—ã–π");

    // Description
    if (!data.description) data.issues.push("‚ùå –ù–µ—Ç Description");
    else if (data.description.length < 150) data.issues.push("‚ö†Ô∏è Description –∫–æ—Ä–æ—Ç–∫–∏–π");
    else if (data.description.length > 160) data.issues.push("‚ö†Ô∏è Description –¥–ª–∏–Ω–Ω—ã–π");

    // Images ALT
    const imgs = [...doc.querySelectorAll("img")];
    data.images_total = imgs.length;
    imgs.forEach(img => {
        let alt = img.getAttribute("alt");
        if (!alt || alt.trim() === "") data.images_missing_alt++;
    });
    if (data.images_missing_alt > 0)
        data.issues.push(`‚ùå –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑ ALT: ${data.images_missing_alt}`);

    // Links
    const domain = new URL(url).hostname;
    [...doc.querySelectorAll("a[href]")].forEach(a => {
        const href = absoluteUrl(url, a.getAttribute("href"));
        if (!href) return;

        if (href.includes(domain)) data.internal_links++;
        else data.external_links++;
    });

    return data;
}

async function runAudit() {
    const url = document.getElementById("urlInput").value.trim();
    const output = document.getElementById("output");

    if (!url) {
        output.textContent = "–í–≤–µ–¥–∏—Ç–µ URL!";
        return;
    }

    output.textContent = "‚è≥ –ó–∞–≥—Ä—É–∂–∞—é —Å—Ç—Ä–∞–Ω–∏—Ü—É...";

    const html = await fetchHTML(url);
    if (!html) {
        output.textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í–æ–∑–º–æ–∂–Ω–æ, —Å–∞–π—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã.";
        return;
    }

    const data = extractSEO(url, html);

    output.textContent =
        `URL: ${data.url}\n\n` +
        `TITLE: ${data.title}\n` +
        `DESCRIPTION: ${data.description}\n` +
        `H1: ${data.h1.join(" | ")}\n` +
        `H2: ${data.h2}\n` +
        `H3: ${data.h3}\n\n` +
        `Images: ${data.images_total}, missing ALT: ${data.images_missing_alt}\n` +
        `Internal links: ${data.internal_links}\n` +
        `External links: ${data.external_links}\n\n` +
        `‚ö†Ô∏è Issues:\n${data.issues.map(i => "‚Ä¢ " + i).join("\n")}`;
}
</script>

</body>
</html>
